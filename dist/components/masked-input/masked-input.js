class u extends HTMLInputElement{#i;#s;#e;async connectedCallback(){this.#e=this.#r.bind(this),this.#s=new a(this.dataset.mask,this.#e),this.#t(),this.#n()}async disconnectedCallback(){this.#i=crsbinding.utils.disposeProperties(this.#i),crsbinding.dom.disableEvents(this),this.#s=this.#s.dispose()}#t(){this.#i=Object.freeze({ArrowLeft:this.#s.moveIndexLeft.bind(this.#s),ArrowRight:this.#s.moveIndexRight.bind(this.#s),Backspace:this.#s.clearBack.bind(this.#s)})}#n(){crsbinding.dom.enableEvents(this),this.registerEvent(this,"focus",this.#h.bind(this)),this.registerEvent(this,"keydown",this.#u.bind(this)),this.registerEvent(this,"click",this.#l.bind(this))}#r(t,i){this.value=t,this.setSelectionRange(i,i)}async#h(t){t.preventDefault(),requestAnimationFrame(()=>{const i=this.#s.currentIndex;this.setSelectionRange(i,i)})}async#l(t){this.selectionEnd-this.selectionStart>1||(t.preventDefault(),requestAnimationFrame(()=>{if(this.#s.isFilled)return this.#s.setCursor(this.selectionStart);const i=this.#s.currentIndex;this.setSelectionRange(i,i)}))}async#u(t){if(!(t.key.toLowerCase()=="a"&&t.ctrlKey==!0)&&t.key!="Tab"&&t.shiftKey!=!0&&(t.preventDefault(),t.key!=" ")){if(this.#i[t.key]!=null)return this.#i[t.key](this.selectionStart,this.selectionEnd);if(this.selectionStart!=this.selectionEnd&&(this.#s.clearBack(this.selectionStart,this.selectionEnd),this.selectionEnd=this.selectionStart),t.key.length==1)return this.#s.set(t.key)}}}const e=Object.freeze(["0","#","_"]);class a{#i;#s;#e;#t;#n;get value(){return this.#s}get currentIndex(){return this.#t}get isFilled(){return this.#e.indexOf("_")==-1}constructor(t,i){this.#i=t,this.#n=i,this.#s=r(t),this.#e=this.#s.split(""),this.setCursor(0),this.#h()}dispose(){return this.#i=null,this.#s=null,this.#e=null,this.#t=null,this.#n=null,null}#r(){if(this.#t==this.#i.length)return!1;const t=this.#i[this.#t];return e.indexOf(t)!=-1==!0||(this.#t+=1,this.#r()),!0}#h(){this.#s=this.#e.join(""),this.#n?.(this.#s,this.#t)}setCursor(t){this.#t=t,this.#r(),this.#h()}set(t){this.#t!=this.#i.length&&this.#r()==!0&&c(this.#i[this.#t],t)&&(this.#e[this.#t]=t,this.#t+=1,this.#t>=this.#i.length&&(this.#t=this.#i.length),this.#h())}clearBack(t,i){if(i-t==this.#i.length)return this.clear();if(i-t>1&&t!=null&&i!=null)return this.clear(t,i);if(this.#t==0)return;this.#t=t-1,(this.#e[this.#t]=="_"||e.indexOf(this.#i[this.#t])==-1)==!0&&(this.#t-=1);const l=this.#i[this.#t];e.indexOf(l)!=-1?(this.#e[this.#t]="_",this.#h()):this.clearBack(t-1,i-1)}clear(t,i){if(t==null)return this.#e=r(this.#i).split(""),this.setCursor(0),this.#h();for(let h=t;h<i;h++){const n=this.#i[h];e.indexOf(n)!=-1&&(this.#e[h]="_")}this.setCursor(t),this.#h()}moveIndexLeft(){if(this.#t==0)return;let t=this.#i[this.#t-1];if(e.indexOf(t)!=-1)return this.#t-=1,this.#h();for(let i=this.#t;i>0;i--)if(t=this.#i[i-1],e.indexOf(t)!=-1){this.#t=i;break}return this.#h()}moveIndexRight(){if(this.#t+=1,this.#t>=this.#i.length)return this.#t=this.#i.length,this.#h();const t=this.#i[this.#t];e.indexOf(t)==-1&&this.moveIndexRight(),this.#h()}}function r(s){return s.split("0").join("_").split("#").join("_")}function c(s,t){const i=isNaN(t);return i==!0&&(s=="#"||s=="_")||i==!1&&(s=="#"||s=="0")}customElements.define("masked-input",u,{extends:"input"});export{a as MaskManager,u as MaskedInput,c as canEdit,r as maskToText};
